<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="930px" preserveAspectRatio="none" style="width:1369px;height:930px;" version="1.1" viewBox="0 0 1369 930" width="1369px" zoomAndPan="magnify"><defs><filter height="300%" id="f5q3358ewagaw" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#F0FFFF" height="918.1172" style="stroke:#A80036;stroke-width:1.0;" width="1076.5" x="220" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="99" x="708.75" y="18.0669">Data Station</text><rect fill="#FFFFFF" filter="url(#f5q3358ewagaw)" height="58.2656" style="stroke:#A80036;stroke-width:1.0;" width="10" x="301" y="119.4297"/><rect fill="#FFFFFF" filter="url(#f5q3358ewagaw)" height="291.0625" style="stroke:#A80036;stroke-width:1.0;" width="10" x="500" y="148.5625"/><rect fill="#FFFFFF" filter="url(#f5q3358ewagaw)" height="219.5313" style="stroke:#A80036;stroke-width:1.0;" width="10" x="500" y="600.2891"/><rect fill="#FFFFFF" filter="url(#f5q3358ewagaw)" height="28" style="stroke:#A80036;stroke-width:1.0;" width="10" x="505" y="667.4219"/><rect fill="#FFFFFF" filter="url(#f5q3358ewagaw)" height="115.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="780" y="265.0938"/><rect fill="#FFFFFF" filter="url(#f5q3358ewagaw)" height="220.6641" style="stroke:#A80036;stroke-width:1.0;" width="10" x="886" y="409.625"/><rect fill="#FFFFFF" filter="url(#f5q3358ewagaw)" height="30" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1161.5" y="789.8203"/><rect fill="#FFFFFF" filter="url(#f5q3358ewagaw)" height="71.2656" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1251.5" y="492.8906"/><rect fill="#FFFFFF" filter="url(#f5q3358ewagaw)" height="117.5313" style="stroke:#000000;stroke-width:2.0;" width="528" x="824.5" y="454.625"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="44" x2="44" y1="88.2969" y2="837.8203"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="306" x2="306" y1="88.2969" y2="837.8203"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="505" x2="505" y1="88.2969" y2="837.8203"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="784.5" x2="784.5" y1="88.2969" y2="837.8203"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="890.5" x2="890.5" y1="88.2969" y2="837.8203"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1034.5" x2="1034.5" y1="88.2969" y2="837.8203"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1166.5" x2="1166.5" y1="88.2969" y2="837.8203"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1256.5" x2="1256.5" y1="88.2969" y2="837.8203"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="5" y="84.9951">Consumer</text><ellipse cx="44" cy="15" fill="#FEFECE" filter="url(#f5q3358ewagaw)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M44,23 L44,50 M31,31 L57,31 M44,50 L31,65 M44,50 L57,65 " fill="none" filter="url(#f5q3358ewagaw)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="5" y="849.8154">Consumer</text><ellipse cx="44" cy="863.1172" fill="#FEFECE" filter="url(#f5q3358ewagaw)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M44,871.1172 L44,898.1172 M31,879.1172 L57,879.1172 M44,898.1172 L31,913.1172 M44,898.1172 L57,913.1172 " fill="none" filter="url(#f5q3358ewagaw)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="158" x="224" y="84.9951">Http Interface (mTLS)</text><path d="M285.5,44 L285.5,68 M285.5,56 L302.5,56 " fill="none" filter="url(#f5q3358ewagaw)" style="stroke:#A80036;stroke-width:2.0;"/><ellipse cx="314.5" cy="56" fill="#FEFECE" filter="url(#f5q3358ewagaw)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="158" x="224" y="849.8154">Http Interface (mTLS)</text><path d="M285.5,857.1172 L285.5,881.1172 M285.5,869.1172 L302.5,869.1172 " fill="none" filter="url(#f5q3358ewagaw)" style="stroke:#A80036;stroke-width:2.0;"/><ellipse cx="314.5" cy="869.1172" fill="#FEFECE" filter="url(#f5q3358ewagaw)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="444" y="84.9951">MessageHandler</text><ellipse cx="505" cy="56" fill="#FEFECE" filter="url(#f5q3358ewagaw)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="501,44,507,39,505,44,507,49,501,44" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="444" y="849.8154">MessageHandler</text><ellipse cx="505" cy="869.1172" fill="#FEFECE" filter="url(#f5q3358ewagaw)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="501,857.1172,507,852.1172,505,857.1172,507,862.1172,501,857.1172" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="745.5" y="84.9951">Nuts Node</text><ellipse cx="785" cy="56" fill="#F08080" filter="url(#f5q3358ewagaw)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="781,44,787,39,785,44,787,49,781,44" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="745.5" y="849.8154">Nuts Node</text><ellipse cx="785" cy="869.1172" fill="#F08080" filter="url(#f5q3358ewagaw)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="781,857.1172,787,852.1172,785,857.1172,787,862.1172,781,857.1172" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="834.5" y="84.9951">VQueryHandler</text><ellipse cx="891" cy="56" fill="#FEFECE" filter="url(#f5q3358ewagaw)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="887,44,893,39,891,44,893,49,887,44" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="834.5" y="849.8154">VQueryHandler</text><ellipse cx="891" cy="869.1172" fill="#FEFECE" filter="url(#f5q3358ewagaw)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="887,857.1172,893,852.1172,891,857.1172,893,862.1172,887,857.1172" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149" x="957.5" y="84.9951">Authorization Server</text><ellipse cx="1035" cy="56" fill="#FEFECE" filter="url(#f5q3358ewagaw)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="1031,44,1037,39,1035,44,1037,49,1031,44" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149" x="957.5" y="849.8154">Authorization Server</text><ellipse cx="1035" cy="869.1172" fill="#FEFECE" filter="url(#f5q3358ewagaw)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="1031,857.1172,1037,852.1172,1035,857.1172,1037,862.1172,1031,857.1172" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="1122.5" y="84.9951">ActivityLog</text><ellipse cx="1166.5" cy="56" fill="#FEFECE" filter="url(#f5q3358ewagaw)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><line style="stroke:#A80036;stroke-width:2.0;" x1="1154.5" x2="1178.5" y1="70" y2="70"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="1122.5" y="849.8154">ActivityLog</text><ellipse cx="1166.5" cy="869.1172" fill="#FEFECE" filter="url(#f5q3358ewagaw)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><line style="stroke:#A80036;stroke-width:2.0;" x1="1154.5" x2="1178.5" y1="883.1172" y2="883.1172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66" x="1220.5" y="84.9951">FAIRData</text><ellipse cx="1256.5" cy="56" fill="#FEFECE" filter="url(#f5q3358ewagaw)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><line style="stroke:#A80036;stroke-width:2.0;" x1="1244.5" x2="1268.5" y1="70" y2="70"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66" x="1220.5" y="849.8154">FAIRData</text><ellipse cx="1256.5" cy="869.1172" fill="#FEFECE" filter="url(#f5q3358ewagaw)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><line style="stroke:#A80036;stroke-width:2.0;" x1="1244.5" x2="1268.5" y1="883.1172" y2="883.1172"/><rect fill="#FFFFFF" filter="url(#f5q3358ewagaw)" height="58.2656" style="stroke:#A80036;stroke-width:1.0;" width="10" x="301" y="119.4297"/><rect fill="#FFFFFF" filter="url(#f5q3358ewagaw)" height="291.0625" style="stroke:#A80036;stroke-width:1.0;" width="10" x="500" y="148.5625"/><rect fill="#FFFFFF" filter="url(#f5q3358ewagaw)" height="219.5313" style="stroke:#A80036;stroke-width:1.0;" width="10" x="500" y="600.2891"/><rect fill="#FFFFFF" filter="url(#f5q3358ewagaw)" height="28" style="stroke:#A80036;stroke-width:1.0;" width="10" x="505" y="667.4219"/><rect fill="#FFFFFF" filter="url(#f5q3358ewagaw)" height="115.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="780" y="265.0938"/><rect fill="#FFFFFF" filter="url(#f5q3358ewagaw)" height="220.6641" style="stroke:#A80036;stroke-width:1.0;" width="10" x="886" y="409.625"/><rect fill="#FFFFFF" filter="url(#f5q3358ewagaw)" height="30" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1161.5" y="789.8203"/><rect fill="#FFFFFF" filter="url(#f5q3358ewagaw)" height="71.2656" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1251.5" y="492.8906"/><polygon fill="#A80036" points="289,115.4297,299,119.4297,289,123.4297,293,119.4297" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="44" x2="295" y1="119.4297" y2="119.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="238" x="51" y="114.3638">POST (body: basic message request)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="498" x2="488" y1="148.5625" y2="144.5625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="498" x2="488" y1="148.5625" y2="152.5625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="311" x2="499" y1="148.5625" y2="148.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170" x="318" y="143.4966">Route to message handler</text><polygon fill="#A80036" points="55,173.6953,45,177.6953,55,181.6953,51,177.6953" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="49" x2="305" y1="177.6953" y2="177.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="61" y="172.6294">200 OK</text><polygon fill="#A80036" points="1154.5,202.8281,1164.5,206.8281,1154.5,210.8281,1158.5,206.8281" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="510" x2="1160.5" y1="206.8281" y2="206.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="517" y="201.7622">Log message request</text><polygon fill="#A80036" points="1023,231.9609,1033,235.9609,1023,239.9609,1027,235.9609" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="510" x2="1029" y1="235.9609" y2="235.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="270" x="517" y="230.895">Verify authorization (bearer access token)</text><polygon fill="#A80036" points="768,261.0938,778,265.0938,768,269.0938,772,265.0938" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="510" x2="774" y1="265.0938" y2="265.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="225" x="517" y="260.0278">Verify Presentation and credentials</text><rect fill="#EEEEEE" filter="url(#f5q3358ewagaw)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1362.5" x="0" y="293.6602"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1362.5" y1="293.6602" y2="293.6602"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1362.5" y1="296.6602" y2="296.6602"/><rect fill="#EEEEEE" filter="url(#f5q3358ewagaw)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="185" x="588.75" y="283.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="156" x="594.75" y="299.1606">Handling verification</text><rect fill="#EEEEEE" filter="url(#f5q3358ewagaw)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1362.5" x="0" y="336.793"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1362.5" y1="336.793" y2="336.793"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1362.5" y1="339.793" y2="339.793"/><rect fill="#EEEEEE" filter="url(#f5q3358ewagaw)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="143" x="609.75" y="326.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="119" x="615.75" y="342.2935">End verification</text><polygon fill="#A80036" points="521,376.4922,511,380.4922,521,384.4922,517,380.4922" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="515" x2="784" y1="380.4922" y2="380.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="246" x="527" y="375.4263">Presentation and credentials accepted</text><line style="stroke:#A80036;stroke-width:1.0;" x1="884" x2="874" y1="409.625" y2="405.625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="884" x2="874" y1="409.625" y2="413.625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="510" x2="885" y1="409.625" y2="409.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124" x="517" y="404.5591">Process credentials</text><path d="M824.5,454.625 L902.5,454.625 L902.5,461.625 L892.5,471.625 L824.5,471.625 L824.5,454.625 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="117.5313" style="stroke:#000000;stroke-width:2.0;" width="528" x="824.5" y="454.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="33" x="839.5" y="467.6919">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="228" x="917.5" y="466.8354">[Embedded Verifiable Credentials]</text><polygon fill="#A80036" points="1239.5,488.8906,1249.5,492.8906,1239.5,496.8906,1243.5,492.8906" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="896" x2="1245.5" y1="492.8906" y2="492.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="300" x="903" y="487.8247">GET /&lt;dataset&gt;/sparql?query=&lt;sparql query&gt;</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1261.5" x2="1303.5" y1="522.0234" y2="522.0234"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1303.5" x2="1303.5" y1="522.0234" y2="535.0234"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1262.5" x2="1303.5" y1="535.0234" y2="535.0234"/><polygon fill="#A80036" points="1272.5,531.0234,1262.5,535.0234,1272.5,539.0234,1268.5,535.0234" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="1268.5" y="516.9575">Query data</text><polygon fill="#A80036" points="907,560.1563,897,564.1563,907,568.1563,903,564.1563" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="901" x2="1255.5" y1="564.1563" y2="564.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60" x="913" y="559.0903">result set</text><polygon fill="#A80036" points="521,596.2891,511,600.2891,521,604.2891,517,600.2891" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="515" x2="885" y1="600.2891" y2="600.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="527" y="595.2231">Send message (result set)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="515" x2="557" y1="659.4219" y2="659.4219"/><line style="stroke:#A80036;stroke-width:1.0;" x1="557" x2="557" y1="659.4219" y2="672.4219"/><line style="stroke:#A80036;stroke-width:1.0;" x1="516" x2="557" y1="672.4219" y2="672.4219"/><polygon fill="#A80036" points="526,668.4219,516,672.4219,526,676.4219,522,672.4219" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="522" y="654.356">create response message</text><polygon fill="#A80036" points="55,727.5547,45,731.5547,55,735.5547,51,731.5547" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="49" x2="499" y1="731.5547" y2="731.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="248" x="61" y="726.4888">POST (body: basic message response)</text><polygon fill="#A80036" points="488,756.6875,498,760.6875,488,764.6875,492,760.6875" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="44" x2="494" y1="760.6875" y2="760.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="51" y="755.6216">200 OK</text><polygon fill="#A80036" points="1149.5,785.8203,1159.5,789.8203,1149.5,793.8203,1153.5,789.8203" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="510" x2="1155.5" y1="789.8203" y2="789.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149" x="517" y="784.7544">Log message response</text><!--MD5=[423141d0f1438a24880cc0ed81f9a91d]
@startuml
actor Consumer
box "Data Station" #Azure
boundary HttpServer as "Http Interface (mTLS)"
control MessageHandler
control VCVerifier as "Nuts Node" #LightCoral
control VQueryHandler
control AuthServer as "Authorization Server"
entity ActivityLog
entity FAIRData
end box

Consumer -> HttpServer ++ : POST (body: basic message request)
HttpServer ->> MessageHandler ++ : Route to message handler
HttpServer - -> Consumer : 200 OK
deactivate HttpServer

    MessageHandler -> ActivityLog : Log message request
    MessageHandler -> AuthServer : Verify authorization (bearer access token)

    MessageHandler -> VCVerifier ++ : Verify Presentation and credentials
    == Handling verification   ==

    == End verification  ==
    VCVerifier - -> MessageHandler - - : Presentation and credentials accepted
    deactivate VCVerifier

    MessageHandler ->> VQueryHandler ++ : Process credentials
deactivate MessageHandler
    


loop Embedded Verifiable Credentials

    VQueryHandler -> FAIRData ++ : GET /<dataset>/sparql?query=<sparql query>
    FAIRData -> FAIRData : Query data
    FAIRData - -> VQueryHandler - - : result set

end
VQueryHandler - -> MessageHandler ++ : Send message (result set)

    deactivate VQueryHandler
    MessageHandler -> MessageHandler ++: create response message
    deactivate MessageHandler

    MessageHandler -> Consumer : POST (body: basic message response)
    Consumer - -> MessageHandler : 200 OK

    MessageHandler -> ActivityLog ++ : Log message response
    deactivate ActivityLog

deactivate MessageHandler
@enduml

PlantUML version 1.2021.01beta3(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>